name: Build and Deploy to Second Repo
on: 
    push: 
        branches: 
            - main

jobs:
    build:
        runs-on: ubuntu-22.04
        steps:
            - name: ğŸ›ï¸ Checkout du repo
              uses: actions/checkout@v4

            - name: ğŸ“¦ Installer les dÃ©pendances
              run: npm install
              
            - name: ğŸ”¨ Build du projet
              run: npm run build

            - name: ğŸš€ DÃ©ploiement vers le 2Ã¨me repo
              run: |
                cd dist

                # VÃ©rifie si un dÃ©pÃ´t git est dÃ©jÃ  initialisÃ©
                if [ ! -d ".git" ]; then
                  git init
                  git config --global user.name "github-actions[bot]"
                  git config --global user.email "github-actions[bot]@users.noreply.github.com"
                  git branch -M main
                fi

                git add .
                git commit -m "ğŸš€ Mise Ã  jour automatique du build"
                
                # Utilisation du token pour le push
                git remote add origin https://x-access-token:${{ secrets.PAT_SECRET }}@github.com/cheick98/cheick98.github.io.git
                git push -f origin main

            - name: âœ… Fin de la tÃ¢che
              run: echo "Tout est bon"
